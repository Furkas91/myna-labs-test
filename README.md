# myna-labs-test
Junior Data Engineering Test Task

## Task
Task is to prepare a dataset that consists of 1,000 photos that have the following properties:

1. Each image contains exactly one human face
2. The size of the face is at least 256x256 pixels
3. The person in the photo is wearing glasses

## Подход к решению
Базовый подход к поиску датасетов 
1. Поиск нужного датасета в интернете
2. Поиск похожего датасета в интернете и подгонка его под свои требования
3. Самостоятельный сбор датасета

переходить к следующему шагу нужно только, если на предыдущем была достигнута неудача
в ходе выполнения этого тестового можно было бы остановится на первом шаге, после нахождения https://paperswithcode.com/dataset/meglass этого прекрасного датасета, но это было бы слишком просто и скучно поэтому, мною было принято решение перейти к следующему этапу

В качестве похожего датасета я стал искать датасеты с лицами, и потом среди них отбирать лица непосредственно в очках, не забывая про то что bbox лица должен быть не меньше 256х256
Среди огромного разнообразия таких датасетов я решил остановиться на https://paperswithcode.com/dataset/ffhq 
Дальше нужно было найти какую нибудь модель для классификации или детектирования, непосредственно очков, мне приглянулись следующие 2 решения:
face alignment с opencv и dlib https://github.com/TianxingWu/realtime-glasses-detection
и классический resnet50 https://github.com/Mianto/glasses
я начал их устанавливать и запускать параллельно, очевидным образом решение c opencv мне удалось запустить куда быстрее, и оставшись впечатленным его скоростью на cpu(у меня довольно слабый ноутбук(реснету на нем было бы очень грустно), а доступа к хорошим серверам на выходных у меня не было) я оставил его в основе
точность классификации оставляла желать лучшего, я немного поиграл с пороговыми значениями для классификации, но точность не сильно превышала 65%, для серьезного и потокового сбора данных такое не годится конечно но для того что бы собрать один датасет почему бы и нет.
Скрипт с этой моделью отобрал 1400 фотографий(за +-полчаса), как он думал в очках и после чего я руками прочистил его от лишнего хлама, что заняло в районе 20-25 минут и получил нужные 1000 фотографий.
ссылка на собранный датасет: https://drive.google.com/file/d/1dcKmkPKpi21xBKgFUB-r0v6c6PNxiUQH/view?usp=sharing

До 3 пункта я решил не доходить, ибо это довольно долго и практически бесполезно учитывая решения, найденные на первых двух этапах, но если бы пришлось то я бы скорее всего вооружившись Beautiful Soup и Selenium начал бы охоту на социальные сети, начиная с вконтакте, но там бы пришлось бы еще использовать еще что-то вроде yolo, обученного на детектирование лиц и отсеивание фотографий по 1 найденному bbox, а после этого тот же пайплайн как и в предыдущем подходе.
